local h = require("hashlib")



describe("sha1", function()
    it("", function()
        local s = h.sha1()
        s:update("asd")
        assert.equal("f10e2821bbbea527ea02200352313bc059445190", s:hexdigest())
        assert.equal("f10e2821bbbea527ea02200352313bc059445190", s:hexdigest())
    end)
    it("", function()
        local s = h.sha1("asd")
        assert.equal("f10e2821bbbea527ea02200352313bc059445190", s:hexdigest())
    end)
end)

describe("sha256", function()
    it("", function()
        local s = h.sha256()
        s:update("Nobody inspects")
        s:update(" the spammish repetition")
        assert.equal("031edd7d41651593c5fe5c006fa5752b37fddff7bc4e843aa6af0c950f4b9406", s:hexdigest())
        assert.equal("031edd7d41651593c5fe5c006fa5752b37fddff7bc4e843aa6af0c950f4b9406", s:hexdigest())
    end)
    it("", function()
        local s = h.sha256("Nobody inspects the spammish repetition")
        assert.equal("031edd7d41651593c5fe5c006fa5752b37fddff7bc4e843aa6af0c950f4b9406", s:hexdigest())
    end)
end)

describe("md5", function()
    it("", function()
        local s = h.md5()
        s:update("The quick brown fox jump over the shining moon")
        assert.equal("04dfafe0021d2a8ffc4f34f22949056a", s:hexdigest())
        assert.equal("04dfafe0021d2a8ffc4f34f22949056a", s:hexdigest())
    end)
    it("", function()
        local s = h.md5("The quick brown fox jump over the shining moon")
        assert.equal("04dfafe0021d2a8ffc4f34f22949056a", s:hexdigest())
        assert.equal("04dfafe0021d2a8ffc4f34f22949056a", s:hexdigest())
    end)
end)
